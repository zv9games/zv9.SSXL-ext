// ============================================================================
// ðŸŽ¼ Chunk Data Query Logic (`crate::engine::query_data`)
// ----------------------------------------------------------------------------
// This module defines the `fetch_chunk_data_logic` function, which provides
// Godot scripts with read-only access to specific chunk data generated by the
// SSXL engine. It acts as a bridge between Rustâ€™s generation API and Godotâ€™s
// scripting layer.
//
// Purpose:
//   â€¢ Allow Godot to request structured chunk data by coordinates (x, y).
//   â€¢ Provide a safe, side-effect-free query into the engineâ€™s generation API.
//   â€¢ Return results in Godotâ€™s native `Dictionary` type for seamless FFI.
//
// Key Components:
//   â€¢ SSXLEngine
//       - Core engine struct exposed to Godot.
//       - Holds references to subsystems including the generation API.
//   â€¢ state! macro
//       - Provides scoped access to the internal state of `SSXLEngine`.
//       - Expands to code that dereferences the internal state pointer safely.
//   â€¢ Dictionary
//       - Godotâ€™s built-in key-value container type.
//       - Used here to return chunk data in a format that Godot scripts can consume.
//
// Function: fetch_chunk_data_logic
//   â€¢ Arguments:
//       - engine: mutable reference to `SSXLEngine`.
//         (mutable required because `state!` macro dereferences internal state,
//         even though this function itself does not mutate).
//       - x, y: integer coordinates of the chunk being requested.
//   â€¢ Workflow:
//       1. Access engineâ€™s internal state via `state!` macro.
//       2. Call `generation_api.fetch_chunk_data(x, y)`.
//       3. Return the resulting `Dictionary` to Godot.
//   â€¢ Returns:
//       - Dictionary containing chunk data (tiles, metadata, etc.).
//       - The exact contents depend on the implementation of `generation_api`.
//
// Design Choices:
//   â€¢ Query-only function ensures no mutation or side effects.
//   â€¢ Returning `Dictionary` aligns with Godotâ€™s native data structures.
//   â€¢ Encapsulation via `generation_api` centralizes data retrieval logic.
//
// Educational Note:
//   â€¢ This function demonstrates how Rust can expose safe, read-only queries
//     to external engines like Godot. By combining macro-based state access,
//     structured data containers, and FFI integration, it provides a clean,
//     ergonomic interface for retrieving chunk data in game scripts.
// ============================================================================


use godot::builtin::Dictionary; 
use crate::engine::state as state_module; 
use state_module::{SSXLEngine, state}; 

pub fn fetch_chunk_data_logic(engine: &mut SSXLEngine, x: i32, y: i32) -> Dictionary {
    state!(engine).generation_api.fetch_chunk_data(x, y)
}
